<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>–•—É–∑–∞ –ù–µ–π—Ä–æ—Å–µ—Ç—å</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

  :root {
    --bg: #0a0a0a;
    --surface: #141414;
    --border: rgba(255,255,255,0.07);
    --text: #ffffff;
    --text-secondary: rgba(255,255,255,0.45);
    --accent: #2e7cf6;
    --selected-bg: rgba(46,124,246,0.12);
    --green: #22c55e;
  }

  * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
  html,body { font-family:'Inter',-apple-system,sans-serif; background:var(--bg); color:var(--text); overflow-x:hidden; }

  /* HEADER */
  .header {
    position:sticky; top:0; z-index:100;
    background:rgba(10,10,10,0.93);
    backdrop-filter:blur(20px); -webkit-backdrop-filter:blur(20px);
    border-bottom:1px solid var(--border);
    padding:11px 15px;
    display:flex; align-items:center; gap:11px;
  }
  .header-emoji {
    width:38px; height:38px; border-radius:10px;
    background:var(--accent);
    display:flex; align-items:center; justify-content:center;
    font-size:18px; flex-shrink:0;
    transition:background 0.3s;
  }
  .header-text { flex:1; min-width:0; }
  .header-title { font-size:15px; font-weight:600; }
  .header-sub { font-size:12px; color:var(--text-secondary); margin-top:1px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
  .header-sub span { color:var(--accent); font-weight:500; }

  /* SEARCH */
  .search-wrap { padding:9px 14px 5px; position:sticky; top:61px; z-index:99; background:var(--bg); }
  .search-container { position:relative; }
  .search-icon { position:absolute; left:11px; top:50%; transform:translateY(-50%); color:var(--text-secondary); pointer-events:none; }
  .search-input {
    width:100%; background:var(--surface); border:1px solid var(--border);
    border-radius:12px; padding:9px 14px 9px 36px;
    color:var(--text); font-family:'Inter',sans-serif; font-size:14px; outline:none;
    transition:border-color 0.2s;
  }
  .search-input::placeholder { color:var(--text-secondary); }
  .search-input:focus { border-color:rgba(46,124,246,0.4); }

  /* CATEGORIES */
  .cats { display:flex; gap:7px; padding:7px 14px; overflow-x:auto; scrollbar-width:none; }
  .cats::-webkit-scrollbar { display:none; }
  .cat-btn {
    background:var(--surface); border:1px solid var(--border); border-radius:20px;
    padding:5px 13px; color:var(--text-secondary); font-size:13px; font-weight:500;
    white-space:nowrap; cursor:pointer; transition:all 0.18s;
    font-family:'Inter',sans-serif; flex-shrink:0;
  }
  .cat-btn.active { background:var(--accent); border-color:var(--accent); color:white; }

  /* LIST */
  .section-header { padding:13px 14px 4px; font-size:11px; font-weight:600; color:var(--text-secondary); letter-spacing:0.9px; text-transform:uppercase; }
  .model-list { padding:4px 0 140px; }

  .model-item {
    display:flex; align-items:center; padding:11px 14px;
    cursor:pointer; border-bottom:1px solid var(--border);
    transition:background 0.12s; position:relative; overflow:hidden;
  }
  .model-item:active { background:rgba(255,255,255,0.03); }
  .model-item.selected { background:var(--selected-bg); }
  .model-item.selected::before {
    content:''; position:absolute; left:0; top:0; bottom:0;
    width:3px; background:var(--accent); border-radius:0 2px 2px 0;
  }

  .model-avatar {
    width:44px; height:44px; border-radius:12px;
    display:flex; align-items:center; justify-content:center;
    font-size:20px; flex-shrink:0; margin-right:12px;
  }
  .model-info { flex:1; min-width:0; }
  .model-name { font-size:15px; font-weight:600; margin-bottom:2px; display:flex; align-items:center; gap:5px; flex-wrap:wrap; }
  .model-desc { font-size:12px; color:var(--text-secondary); line-height:1.35; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }

  .model-right { display:flex; flex-direction:column; align-items:flex-end; gap:5px; margin-left:10px; flex-shrink:0; }

  .check-icon {
    width:20px; height:20px; border-radius:50%; background:var(--accent);
    display:flex; align-items:center; justify-content:center;
    opacity:0; transition:opacity 0.2s, transform 0.2s; transform:scale(0.6);
  }
  .model-item.selected .check-icon { opacity:1; transform:scale(1); }

  .badge-vision {
    font-size:9px; font-weight:700; background:rgba(245,158,11,0.12);
    color:#f59e0b; border:1px solid rgba(245,158,11,0.25);
    padding:2px 6px; border-radius:5px; white-space:nowrap;
  }
  .badge-active {
    font-size:9px; font-weight:700; background:rgba(34,197,94,0.12);
    color:var(--green); border:1px solid rgba(34,197,94,0.25);
    padding:2px 6px; border-radius:5px;
  }

  /* –ù–ò–ñ–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ ‚Äî –æ–¥–Ω–∞ –∫–Ω–æ–ø–∫–∞, –±–µ–∑ MainButton –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è */
  .bottom-panel {
    position:fixed; bottom:0; left:0; right:0;
    padding:10px 14px;
    padding-bottom:calc(10px + env(safe-area-inset-bottom));
    background:rgba(10,10,10,0.96);
    backdrop-filter:blur(20px); -webkit-backdrop-filter:blur(20px);
    border-top:1px solid var(--border);
    z-index:200;
    transform:translateY(120%);
    transition:transform 0.25s cubic-bezier(0.34,1.56,0.64,1);
  }
  .bottom-panel.show { transform:translateY(0); }

  .bottom-row { display:flex; align-items:center; gap:10px; }
  .bottom-info { flex:1; min-width:0; }
  .bottom-model-name { font-size:14px; font-weight:600; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
  .bottom-hint { font-size:11px; color:var(--text-secondary); }

  .confirm-btn {
    background:var(--accent); color:white; border:none; border-radius:13px;
    padding:11px 20px; font-size:15px; font-weight:600;
    font-family:'Inter',sans-serif; cursor:pointer; flex-shrink:0;
    transition:opacity 0.15s, transform 0.1s; white-space:nowrap;
  }
  .confirm-btn:active { opacity:0.8; transform:scale(0.97); }
  .confirm-btn.done { background:var(--green); }

  .empty-state { text-align:center; padding:50px 20px; color:var(--text-secondary); font-size:14px; }

  /* Avatars */
  .av-claude   { background:linear-gradient(135deg,#d4845a,#c9512f); }
  .av-gpt      { background:linear-gradient(135deg,#10a37f,#0a7a5f); }
  .av-deepseek { background:linear-gradient(135deg,#4e6ef2,#2a42c4); }
  .av-qwen     { background:linear-gradient(135deg,#8b5cf6,#6d28d9); }
  .av-llama    { background:linear-gradient(135deg,#f59e0b,#d97706); }
  .av-command  { background:linear-gradient(135deg,#6b7280,#374151); }
  .av-kimi     { background:linear-gradient(135deg,#ec4899,#be185d); }
  .av-glm      { background:linear-gradient(135deg,#a78bfa,#7c3aed); }
  .av-c4ai     { background:linear-gradient(135deg,#06b6d4,#0891b2); }
  .av-sonar    { background:linear-gradient(135deg,#f97316,#ea580c); }

  @keyframes ripple { from{transform:scale(0);opacity:0.35;} to{transform:scale(3.5);opacity:0;} }
  .ripple { position:absolute; border-radius:50%; background:rgba(46,124,246,0.22); animation:ripple 0.5s ease-out forwards; pointer-events:none; width:50px; height:50px; margin:-25px; }

  @keyframes fadeIn { from{opacity:0;transform:translateY(6px);} to{opacity:1;transform:translateY(0);} }
  .model-item { animation:fadeIn 0.22s ease both; }
</style>
</head>
<body>

<div class="header">
  <div class="header-emoji" id="headerEmoji">ü§ñ</div>
  <div class="header-text">
    <div class="header-title">–í—ã–±–æ—Ä –Ω–µ–π—Ä–æ—Å–µ—Ç–∏</div>
    <div class="header-sub">–ê–∫—Ç–∏–≤–Ω–∞: <span id="curModelName">‚Äî</span></div>
  </div>
</div>

<div class="search-wrap">
  <div class="search-container">
    <svg class="search-icon" width="15" height="15" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
    </svg>
    <input class="search-input" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –º–æ–¥–µ–ª–∏..." autocomplete="off" spellcheck="false">
  </div>
</div>

<div class="cats" id="cats"></div>
<div class="model-list" id="modelList"></div>

<!-- –û–¥–Ω–∞ –Ω–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å ‚Äî —Ç–æ–ª—å–∫–æ –æ–Ω–∞, –±–µ–∑ MainButton -->
<div class="bottom-panel" id="bottomPanel">
  <div class="bottom-row">
    <div class="bottom-info">
      <div class="bottom-model-name" id="bottomModelName">‚Äî</div>
      <div class="bottom-hint" id="bottomHint">–ù–∞–∂–º–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏</div>
    </div>
    <button class="confirm-btn" id="confirmBtn" onclick="confirmSelection()">–í—ã–±—Ä–∞—Ç—å ‚úì</button>
  </div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();
tg.expand();
// –°–∫—Ä—ã–≤–∞–µ–º –Ω–∞—Ç–∏–≤–Ω—ã–π MainButton —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –¥–≤—É—Ö –∫–Ω–æ–ø–æ–∫
if (tg.MainButton) tg.MainButton.hide();

const MODELS = [
  {key:"claude_sonnet", name:"Claude Sonnet 4.5", emoji:"üî∑", av:"av-claude",   cat:"Claude",   desc:"–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å ‚Äî —É–º–Ω–∞—è, –±—ã—Å—Ç—Ä–∞—è, –¥–µ—Ç–∞–ª—å–Ω–∞—è"},
  {key:"claude_haiku",  name:"Claude Haiku 4.5",  emoji:"üíé", av:"av-claude",   cat:"Claude",   desc:"–°–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è –≤–µ—Ä—Å–∏—è Claude –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –∑–∞–¥–∞—á"},
  {key:"claude_opus",   name:"Claude Opus 4.5",   emoji:"üîµ", av:"av-claude",   cat:"Claude",   desc:"–¢–æ–ø–æ–≤–∞—è –º–æ–¥–µ–ª—å Anthropic ‚Äî –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑"},
  {key:"gpt52",         name:"GPT-5.2",            emoji:"‚ö°", av:"av-gpt",     cat:"GPT",      desc:"–ù–æ–≤–µ–π—à–∞—è –∏ —Å–∞–º–∞—è –º–æ—â–Ω–∞—è –º–æ–¥–µ–ª—å –æ—Ç OpenAI"},
  {key:"gpt52_chat",    name:"GPT-5.2 Chat",       emoji:"üí¨", av:"av-gpt",     cat:"GPT",      desc:"GPT-5.2 –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤"},
  {key:"deepseek_v3",   name:"DeepSeek V3.2",      emoji:"üß¨", av:"av-deepseek",cat:"DeepSeek", desc:"–£–º–Ω–µ–π—à–∞—è –∫–∏—Ç–∞–π—Å–∫–∞—è –º–æ–¥–µ–ª—å ‚Äî –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç OpenAI o1"},
  {key:"deepseek_r1",   name:"DeepSeek R1",        emoji:"üß†", av:"av-deepseek",cat:"DeepSeek", desc:"Reasoning-–º–æ–¥–µ–ª—å —Å —Ü–µ–ø–æ—á–∫–æ–π —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π, —Ç–æ–ø –¥–ª—è –ª–æ–≥–∏–∫–∏"},
  {key:"deepseek_v3_sq",name:"DeepSeek V3",        emoji:"üß¨", av:"av-deepseek",cat:"DeepSeek", desc:"–°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è DeepSeek V3 ‚Äî –±—ã—Å—Ç—Ä–∞—è –∏ –Ω–∞–¥—ë–∂–Ω–∞—è"},
  {key:"qwen3_max",     name:"Qwen3-Max",           emoji:"üåê", av:"av-qwen",   cat:"Qwen",     desc:"–§–ª–∞–≥–º–∞–Ω—Å–∫–∞—è –º–æ–¥–µ–ª—å Alibaba ‚Äî –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–∞—è, –º–æ—â–Ω–∞—è"},
  {key:"qwen3_vl",      name:"Qwen3-VL",            emoji:"üëÅÔ∏è", av:"av-qwen",  cat:"Qwen",     desc:"Vision ‚Äî –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ñ–æ—Ç–æ",    vision:true},
  {key:"qwen_vision",   name:"Qwen2.5-VL 32B",      emoji:"üñºÔ∏è", av:"av-qwen",  cat:"Qwen",     desc:"–ú–æ—â–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, 32B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤", vision:true},
  {key:"llama32_90b",   name:"Llama 3.2 90B",       emoji:"ü¶ô", av:"av-llama",  cat:"Llama",    desc:"Open-source –≥–∏–≥–∞–Ω—Ç –æ—Ç Meta ‚Äî Vision, 90B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤", vision:true},
  {key:"command_a",     name:"Command-A",            emoji:"‚öôÔ∏è", av:"av-command",cat:"Command",  desc:"–ë–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª—å –æ—Ç Cohere ‚Äî —Ç–æ—á–Ω–∞—è –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è"},
  {key:"command_vision",name:"Command Vision",       emoji:"üëÅÔ∏è", av:"av-command",cat:"Command", desc:"Command —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π", vision:true},
  {key:"command_reason",name:"Command Reasoning",    emoji:"üß©", av:"av-command",cat:"Command",  desc:"Command —Å —É–≥–ª—É–±–ª—ë–Ω–Ω—ã–º —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–µ–º"},
  {key:"moonshot",      name:"Kimi K2",              emoji:"üåô", av:"av-kimi",   cat:"Kimi",     desc:"–ú–æ–¥–µ–ª—å –æ—Ç Moonshot AI ‚Äî –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ"},
  {key:"glm47",         name:"GLM-4.7",              emoji:"üîÆ", av:"av-glm",    cat:"GLM",      desc:"–ù–æ–≤–µ–π—à–∞—è –≤–µ—Ä—Å–∏—è GLM –æ—Ç Zhipu AI"},
  {key:"glm46",         name:"GLM-4.6",              emoji:"üîÆ", av:"av-glm",    cat:"GLM",      desc:"–°—Ç–∞–±–∏–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å GLM-4.6"},
  {key:"c4ai_32b",      name:"C4AI Aya 32B",         emoji:"üåÄ", av:"av-c4ai",   cat:"C4AI",     desc:"–ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–∞—è ‚Äî 32B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, 23 —è–∑—ã–∫–∞"},
  {key:"c4ai_8b",       name:"C4AI Aya 8B",          emoji:"üåÄ", av:"av-c4ai",   cat:"C4AI",     desc:"–õ—ë–≥–∫–∞—è –∏ –±—ã—Å—Ç—Ä–∞—è –≤–µ—Ä—Å–∏—è Aya ‚Äî 8B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"},
  {key:"c4ai_vis32b",   name:"C4AI Vision 32B",      emoji:"üåÄ", av:"av-c4ai",   cat:"C4AI",     desc:"Vision Aya 32B ‚Äî –∞–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π", vision:true},
  {key:"c4ai_vis8b",    name:"C4AI Vision 8B",       emoji:"üåÄ", av:"av-c4ai",   cat:"C4AI",     desc:"–ë—ã—Å—Ç—Ä–∞—è Vision Aya 8B", vision:true},
  {key:"sonar",         name:"Sonar",                emoji:"üîç", av:"av-sonar",  cat:"Sonar",    desc:"Perplexity Sonar ‚Äî –ø–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ + –ò–ò"},
  {key:"sonar_pro",     name:"Sonar Pro",            emoji:"üîç", av:"av-sonar",  cat:"Sonar",    desc:"–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π Sonar —Å –≥–ª—É–±–æ–∫–∏–º –ø–æ–∏—Å–∫–æ–º"},
];

const CATS = ["–í—Å–µ","Claude","GPT","DeepSeek","Qwen","Llama","Command","Kimi","GLM","C4AI","Sonar"];

const params = new URLSearchParams(location.search);
let currentKey = params.get("model") || "claude_sonnet";
let selectedKey = currentKey;
let currentCat  = "–í—Å–µ";
let searchQ     = "";

// ‚îÄ‚îÄ –ó–∞–≥–æ–ª–æ–≤–æ–∫ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updateHeader() {
  const cur = MODELS.find(m => m.key === currentKey);
  const sel = MODELS.find(m => m.key === selectedKey);
  document.getElementById("curModelName").textContent = cur ? cur.name : currentKey;
  const emoji = document.getElementById("headerEmoji");
  emoji.textContent = sel ? sel.emoji : "ü§ñ";
  emoji.style.background = sel && sel.key !== currentKey ? "#2e7cf6" : "";
}

// ‚îÄ‚îÄ –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updatePanel() {
  const panel = document.getElementById("bottomPanel");
  const sel = MODELS.find(m => m.key === selectedKey);

  if (selectedKey && selectedKey !== currentKey) {
    document.getElementById("bottomModelName").textContent = sel ? sel.name : selectedKey;
    document.getElementById("bottomHint").textContent = sel && sel.vision
      ? "üì∏ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ!"
      : "–ù–∞–∂–º–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏";
    panel.classList.add("show");
  } else {
    panel.classList.remove("show");
  }
}

// ‚îÄ‚îÄ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function confirmSelection() {
  if (!selectedKey || selectedKey === currentKey) return;
  if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred("medium");

  const btn = document.getElementById("confirmBtn");
  btn.textContent = "‚úì –ì–æ—Ç–æ–≤–æ!";
  btn.classList.add("done");
  btn.onclick = null;

  const payload = JSON.stringify({action:"set_model", model:selectedKey});
  try {
    tg.sendData(payload);
  } catch(e) {
    console.warn("sendData:", e);
    setTimeout(() => tg.close(), 700);
  }
}

// ‚îÄ‚îÄ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderCats() {
  document.getElementById("cats").innerHTML = CATS.map(c =>
    `<button class="cat-btn${c===currentCat?' active':''}" onclick="setCat('${c}')">${c}</button>`
  ).join("");
}
function setCat(c) { currentCat=c; renderCats(); renderModels(); }

// ‚îÄ‚îÄ –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function getFiltered() {
  return MODELS.filter(m => {
    const mc = currentCat==="–í—Å–µ" || m.cat===currentCat;
    const q  = searchQ.toLowerCase();
    const mq = !q || m.name.toLowerCase().includes(q) || m.desc.toLowerCase().includes(q) || m.cat.toLowerCase().includes(q);
    return mc && mq;
  });
}

function renderModels() {
  const list = document.getElementById("modelList");
  const filtered = getFiltered();
  if (!filtered.length) { list.innerHTML='<div class="empty-state">üòî –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>'; return; }

  let html = "";
  if (currentCat==="–í—Å–µ" && !searchQ) {
    let lastCat = null;
    filtered.forEach((m,i) => {
      if (m.cat!==lastCat) { html+=`<div class="section-header">${m.cat}</div>`; lastCat=m.cat; }
      html += mHtml(m);
    });
  } else {
    filtered.forEach(m => html+=mHtml(m));
  }
  list.innerHTML = html;
  list.querySelectorAll(".model-item").forEach((el,i) => el.style.animationDelay=`${i*22}ms`);
}

function mHtml(m) {
  const isSel = m.key===selectedKey;
  const isCur = m.key===currentKey;
  const tagCur = isCur ? `<span class="badge-active">–∞–∫—Ç–∏–≤–Ω–∞</span>` : "";
  const tagVis = m.vision ? `<span class="badge-vision">üì∏ VISION</span>` : "";
  return `
    <div class="model-item${isSel?' selected':''}" id="item-${m.key}" onclick="selectModel('${m.key}',event)">
      <div class="model-avatar ${m.av}">${m.emoji}</div>
      <div class="model-info">
        <div class="model-name">${m.name}${tagCur}</div>
        <div class="model-desc">${m.desc}</div>
      </div>
      <div class="model-right">
        <div class="check-icon">
          <svg width="11" height="11" viewBox="0 0 12 12" fill="none">
            <path d="M2 6l3 3 5-5" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        ${tagVis}
      </div>
    </div>`;
}

function selectModel(key, event) {
  // ripple
  const item = document.getElementById(`item-${key}`);
  const r = document.createElement("div");
  r.className = "ripple";
  const rect = item.getBoundingClientRect();
  r.style.left = (event.clientX - rect.left)+"px";
  r.style.top  = (event.clientY - rect.top)+"px";
  item.appendChild(r);
  setTimeout(() => r.remove(), 550);

  if (selectedKey) {
    const old = document.getElementById(`item-${selectedKey}`);
    if (old) old.classList.remove("selected");
  }
  selectedKey = key;
  item.classList.add("selected");
  if (tg.HapticFeedback) tg.HapticFeedback.selectionChanged();
  updateHeader();
  updatePanel();
}

document.getElementById("searchInput").addEventListener("input", e => {
  searchQ = e.target.value;
  if (searchQ && currentCat!=="–í—Å–µ") { currentCat="–í—Å–µ"; renderCats(); }
  renderModels();
});

// ‚îÄ‚îÄ –°—Ç–∞—Ä—Ç ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
renderCats();
renderModels();
updateHeader();
updatePanel();
</script>
</body>
</html>
